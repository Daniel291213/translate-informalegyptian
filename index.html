<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Egyptian Arabic Translator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- PWA -->
<meta name="theme-color" content="#1a73e8">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f1f3f4;
  margin: 0;
}
.container {
  max-width: 700px;
  margin: auto;
  padding: 15px;
}
h2 {
  text-align: center;
}
.box {
  background: white;
  border-radius: 8px;
  padding: 10px;
  margin-bottom: 10px;
}
textarea {
  width: 100%;
  height: 140px;
  border: none;
  resize: none;
  font-size: 18px;
  outline: none;
}
.buttons {
  display: flex;
  gap: 10px;
}
button {
  flex: 1;
  padding: 12px;
  font-size: 16px;
  border: none;
  border-radius: 6px;
  background: #1a73e8;
  color: white;
}
button.secondary {
  background: #5f6368;
}
</style>
</head>

<body>

<div class="container">
  <h2>üåç Egyptian Arabic Translator</h2>

  <div class="box">
    <textarea id="input" placeholder="Type or speak‚Ä¶ (English or Masri)"></textarea>
  </div>

  <div class="buttons">
    <button onclick="voiceInput()">üé§ Voice</button>
    <button onclick="translateText()">Translate</button>
  </div>

  <div class="box">
    <textarea id="output" readonly placeholder="Translation"></textarea>
  </div>
</div>

<script>
const OPENAI_API_KEY = "PUT_YOUR_OPENAI_API_KEY_HERE";

async function translateText() {
  const text = document.getElementById("input").value.trim();
  if (!text) return;

  const systemPrompt = `
You are an expert translator.

Rules:
1. Automatically detect if the input is English or Egyptian Arabic (Masri).
2. If English ‚Üí translate to INFORMAL Egyptian Arabic ONLY (no MSA).
3. If Egyptian Arabic ‚Üí translate to natural English.
4. Preserve slang, jokes, emotion, tone.
5. Prefer Cairo slang, but keep it understandable across Egypt.
6. NEVER use Modern Standard Arabic.
7. Output ONLY the translation text.
`;

  const response = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + OPENAI_API_KEY
    },
    body: JSON.stringify({
      model: "gpt-4o-mini",
      messages: [
        { role: "system", content: systemPrompt },
        { role: "user", content: text }
      ],
      temperature: 0.25
    })
  });

  const data = await response.json();
  document.getElementById("output").value =
    data.choices[0].message.content;
}

// Voice input
function voiceInput() {
  const SpeechRecognition =
    window.SpeechRecognition || window.webkitSpeechRecognition;
  const recognition = new SpeechRecognition();
  recognition.lang = "ar-EG";
  recognition.start();

  recognition.onresult = (event) => {
    document.getElementById("input").value =
      event.results[0][0].transcript;
  };
}
</script>

</body>
</html>
